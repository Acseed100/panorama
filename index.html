<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Droninho</title>
    <link rel="stylesheet" href="./style/style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.pannellum.org/2.5/pannellum.css">
    <script type="text/javascript" src="https://cdn.pannellum.org/2.5/pannellum.js"></script>
</head>
<body>
    <!-- Header stays persistent -->
    <header>
        <a href="#home" onclick="loadPage('home')">Home</a>
        <a href="#panorama" onclick="loadPage('panorama')">Panorama</a>
        <a href="#image" onclick="loadPage('image')">Image</a>
        <a href="#video" onclick="loadPage('video')">Video</a>
    </header>

    <!-- Radio player stays persistent -->
    <div class="media-player">
        <audio controls autoplay>
            <source src="song.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        <button class="lyrics-btn" onclick="showLyrics()">Show Lyrics</button>
    </div>

    <!-- Content container -->
    <div id="content">
        <!-- Default content for Home -->
        <div class="container" id="home">
            <img src="./pictures/dji.png" alt="DJI Drone" class="drone-image">
            <h1>Droninho</h1>
        </div>

        <!-- Panorama Content -->
        <div class="container" id="panorama" style="display:none">
            <div class="panorama-wrapper">
                <!-- Panorama viewer -->
                <div class="panorama-container">
                    <div id="panoramaViewer"></div>
                </div>
                
                <!-- Buttons section -->
                <div class="panorama-section">
                    <div class="row">
                        <h2 class="row-title">Vulcan</h2>
                        <div class="panorama-buttons video-buttons">
                            <button onclick="loadPanorama('./panoramas/pc/Vulcan.JPG', './panoramas/mobile/Vulcan_m.jpg')">Day</button>
                        </div>
                    </div>

                    <div class="row">
                        <h2 class="row-title">Alba Iulia</h2>
                        <div class="panorama-buttons video-buttons">
                            <button onclick="loadPanorama('../panoramas/pc/Carolina.JPG', '../panoramas/mobile/Carolina_m.jpg')">Carolina Mall</button>
                            <button onclick="loadPanorama('../panoramas/pc/Cetate_night.JPG', '../panoramas/mobile/Cetate_night_m.jpg')">Cetate night</button>
                            <button onclick="loadPanorama('../panoramas/pc/Mercur.JPG', '../panoramas/mobile/Mercur_m.jpg')">Mercur</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Image Content -->
        <div class="container" id="image" style="display:none">
            <h2>Image Content Placeholder</h2>
        </div>

        <!-- Video Content -->
        <div class="container" id="video" style="display:none">
            <div class="video-section">
                <div class="row">
                    <h2 class="row-title">Vulcan</h2>
                    <div class="video-buttons">
                        <button class="video-button" data-video-url="https://www.youtube.com/embed/3nHPsH9rt1w">Day</button>
                        <button class="video-button" data-video-url="https://www.youtube.com/embed/9Zz2dJDDZec">Night</button>
                    </div>
                </div>

                <div class="row">
                    <h2 class="row-title">Alba Iulia</h2>
                    <div class="video-buttons">
                        <button class="video-button" data-video-url="https://www.youtube.com/embed/smMFFZ20aiI">Parada militara 2024</button>
                        <button class="video-button" data-video-url="https://www.youtube.com/embed/pHdIFXCtWJ4">Night Flight</button>
                    </div>
                </div>
            </div>

            <!-- Video Modal -->
            <div id="video-modal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeVideo()">&times;</span>
                    <iframe id="video-frame" width="100%" height="500" src="" frameborder="0" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>

    <!-- Lyrics Modal -->
    <div class="lyrics-overlay" id="lyricsOverlay"></div>
    <div class="lyrics-modal" id="lyricsModal">
        <button class="lyrics-modal-close" onclick="closeLyrics()">Close</button>
        <h2>Lyrics</h2>
        <p>
            (Intro) Yo, we out here soaring, higher than the rim, DJI Mini 4 Pro, let the flight begin. ...
            <br> (Outro) So here's to my Mini, my superstar drone, MVP of the skies, yeah, it's in a league of its own.
        </p>
    </div>

    <script>
        // Function to load content pages without loading new HTML
        function loadPage(page) {
            console.log("Loading page:", page);
            // Hide all pages first
            const pages = document.querySelectorAll('.container');
            pages.forEach(p => p.style.display = 'none');
            
            // Show the selected page
            document.getElementById(page).style.display = 'block';

            // Update URL to show only the hash
            if (window.location.pathname !== '/') {
                window.history.replaceState(null, '', '/#' + page);
            } else {
                window.history.replaceState(null, '', '#' + page);
            }
        }

        // Handle the initial page load based on hash
        document.addEventListener('DOMContentLoaded', function() {
            // Get the hash from URL or default to 'home'
            const initialPage = window.location.hash.slice(1) || 'home';
            loadPage(initialPage);

            // Listen for hash changes
            window.addEventListener('hashchange', function() {
                const page = window.location.hash.slice(1) || 'home';
                loadPage(page);
            });
        });

        // Function to show lyrics modal
        function showLyrics() {
            document.getElementById('lyricsModal').style.display = 'block';
            document.getElementById('lyricsOverlay').style.display = 'block';
        }

        function closeLyrics() {
            document.getElementById('lyricsModal').style.display = 'none';
            document.getElementById('lyricsOverlay').style.display = 'none';
        }

        // Panorama loading function
        function isMobile() {
            return window.innerWidth <= 768; // Check if the device is mobile
        }

        function loadPanorama(desktopImage, mobileImage) {
            console.log('Load panorama triggered with:', desktopImage, mobileImage);
            const image = isMobile() ? mobileImage : desktopImage;

            const viewer = pannellum.viewer('panoramaViewer', {
                "type": "equirectangular",
                "panorama": image,
                "autoLoad": true
            });
        }

        // Video modal functions
        document.addEventListener('DOMContentLoaded', function() {
            function openVideo(url) {
                const modal = document.getElementById('video-modal');
                const videoFrame = document.getElementById('video-frame');
                videoFrame.src = url;
                modal.style.display = 'block';
            }

            function closeVideo() {
                const modal = document.getElementById('video-modal');
                const videoFrame = document.getElementById('video-frame');
                videoFrame.src = ''; // Clear the video source
                modal.style.display = 'none';
            }

            window.onclick = function(event) {
                const modal = document.getElementById('video-modal');
                if (event.target === modal) {
                    closeVideo();
                }
            }

            const buttons = document.querySelectorAll('.video-button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    const videoUrl = button.getAttribute('data-video-url');
                    openVideo(videoUrl);
                });
            });
        });
    </script>
</body>
</html>